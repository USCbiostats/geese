# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#' @title Flock of GEESE
#' @description Flocks are pooled models which include multiple phylums.
#' @name flock-class
#' @export
#' @aliases flock
new_flock <- function() {
    .Call(`_geese_new_flock`)
}

#' @rdname flock-class
#' @param p An object of class `flock`.
#' @param annotations Vector of integer vectors with annotations.
#' @param geneid integer vector with gene ids.
#' @param parent integer vector with parent gene id.
#' @param duplication logical vector indicating the type of event.
#' @export
add_geese <- function(p, annotations, geneid, parent, duplication) {
    invisible(.Call(`_geese_add_geese`, p, annotations, geneid, parent, duplication))
}

#' @title Common functions for `geese` and `flock`.
#' @name geese-common
#' @param p An object of class [geese] or [flock].
#' @param verb Integer scalar. When `>1`, it will print a progress bar during
#' the initialization of the process of length `verb`.
#' @export
#' @aliases flock-common
#' @details `init_model` initializes the model. This triggers the calculation
#' of the support using the vector of terms included. Initializing a model can
#' only be done once.
init_model <- function(p, verb = 80L) {
    invisible(.Call(`_geese_init_model`, p, verb))
}

#' @rdname geese-common
#' @export
#' @returns `nterms` returns the number of terms included in the model. This
#' is different from the number of parameters as the later includes the number
#' of functions in the data.
nterms <- function(p) {
    .Call(`_geese_nterms`, p)
}

#' @rdname geese-common
#' @returns `nnodes` returns the number of nodes in the data, this includes
#' internal nodes. If `p` is a [flock], then it will return a vector of length
#' `ntrees()`.
#' @export
nnodes <- function(p) {
    .Call(`_geese_nnodes`, p)
}

#' @rdname geese-common
#' @returns `ntrees` returns the number of trees in the model. For a geese object
#' this will be equal to one.
#' @export
ntrees <- function(p) {
    .Call(`_geese_ntrees`, p)
}

#' @rdname geese-common
#' @export
nleafs <- function(p) {
    .Call(`_geese_nleafs`, p)
}

#' @rdname geese-common
#' @export
#' @param par Numeric vector of length `nterms()`.
#' @param trunc_seq When `TRUE` uses the truncated pruning sequence (see details).
#' @details Using the truncated pruning sequence (`trunc_seq = TRUE`) involves
#' traversing the trees throught the induced subtree. This is relevant in the case
#' that not all the leafs are annotated.
likelihood <- function(p, par, as_log = FALSE, trunc_seq = TRUE) {
    .Call(`_geese_likelihood`, p, par, as_log, trunc_seq)
}

#' @rdname geese-common
#' @export
get_probabilities <- function(p) {
    .Call(`_geese_get_probabilities`, p)
}

#' @rdname geese-common
#' @export
get_sequence <- function(p, reduced_sequence = TRUE) {
    .Call(`_geese_get_sequence`, p, reduced_sequence)
}

#' @rdname geese-common
#' @export
set_seed <- function(p, s) {
    invisible(.Call(`_geese_set_seed`, p, s))
}

#' @rdname geese-common
#' @export
sim_geese <- function(p, par, seed = -1L) {
    .Call(`_geese_sim_geese`, p, par, seed)
}

#' @rdname geese-common
#' @export
observed_counts <- function(p) {
    .Call(`_geese_observed_counts`, p)
}

#' @rdname geese-common
#' @export
print_observed_counts <- function(p) {
    invisible(.Call(`_geese_print_observed_counts`, p))
}

#' @rdname geese-common
#' @export
support_size <- function(p) {
    .Call(`_geese_support_size`, p)
}

#' @rdname geese-common
#' @export
parse_polytomies <- function(p, verbose = TRUE) {
    .Call(`_geese_parse_polytomies`, p, verbose)
}

#' @rdname geese-common
#' @export
nfuns <- function(p) {
    .Call(`_geese_nfuns`, p)
}

#' @rdname geese-common
#' @export
names.geese <- function(p) {
    .Call(`_geese_names_geese`, p)
}

#' Compute the transition probability
#' @param p An object of class `geese` or `flock`.
#' @param params A vector of model parameters.
#' @param duplication logical scalar. Type of evolutionary event.
#' @param state logical vector. State of the parent.
#' @param array matrix indicating the state of the offspring (rows = function, cols = offspring).
#' @param as_log logical scalar. When `TRUE` returns the log.
#' @export
transition_prob <- function(p, params, duplication, state, array, as_log = FALSE) {
    .Call(`_geese_transition_prob`, p, params, duplication, state, array, as_log)
}

#' @export
#' @rdname transition_prob
#' @param i,j Locations (index from zero) of the cell to compute.
#' @details `conditional_prob` computes the so-called "Gibbs sampling"
#' probability, in which the likelihood of observing Y(i,j) = 1 conditional
#' on the rest of the data is computed.
conditional_prob <- function(p, params, duplication, state, array, i, j, as_log = FALSE) {
    .Call(`_geese_conditional_prob`, p, params, duplication, state, array, i, j, as_log)
}

print_geese <- function(p) {
    invisible(.Call(`_geese_print_geese`, p))
}

#' Returns the support of the model
#' @export
get_support <- function(p) {
    .Call(`_geese_get_support`, p)
}

#' @title Evolutionary terms
#' @description Model terms for both [geese] and [flock] objects.
#' @export
#' @param p An object of class [geese] or [flock].
#' @param funs Vector of function indices (starting from zero).
#' @param duplication When `TRUE` indicates that this term is only valid for
#' duplication events.
#' @name geese-terms
rule_limit_changes <- function(p, term_pos, lb, ub, duplication = TRUE) {
    invisible(.Call(`_geese_rule_limit_changes`, p, term_pos, lb, ub, duplication))
}

#' @export
#' @rdname geese-common
predict_geese <- function(p, par, leave_one_out = FALSE, use_reduced_sequence = TRUE, only_annotated = FALSE) {
    .Call(`_geese_predict_geese`, p, par, leave_one_out, use_reduced_sequence, only_annotated)
}

#' @export
#' @rdname geese-common
predict_flock <- function(p, par, leave_one_out = FALSE, use_reduced_sequence = TRUE, only_annotated = FALSE) {
    .Call(`_geese_predict_flock`, p, par, leave_one_out, use_reduced_sequence, only_annotated)
}

#' @title Evolutionary terms
#' @description Model terms for both [geese] and [flock] objects.
#' @export
#' @param p An object of class [geese] or [flock].
#' @param funs Vector of function indices (starting from zero).
#' @param duplication When `TRUE` indicates that this term is only valid for
#' duplication events.
#' @name geese-terms
term_gains <- function(p, funs, duplication = 1L) {
    invisible(.Call(`_geese_term_gains`, p, funs, duplication))
}

#' @export
#' @rdname geese-terms
term_loss <- function(p, funs, duplication = 1L) {
    invisible(.Call(`_geese_term_loss`, p, funs, duplication))
}

#' @export
#' @rdname geese-terms
#' @param a,b Indices of functions (starting from zero)
term_cogain <- function(p, a, b, duplication = 1L) {
    invisible(.Call(`_geese_term_cogain`, p, a, b, duplication))
}

#' @export
#' @rdname geese-terms
term_neofun <- function(p, a, b, duplication = 1L) {
    invisible(.Call(`_geese_term_neofun`, p, a, b, duplication))
}

#' @export
#' @rdname geese-terms
term_subfun <- function(p, a, b, duplication = 1L) {
    invisible(.Call(`_geese_term_subfun`, p, a, b, duplication))
}

#' @export
#' @rdname geese-terms
#' @param lb,ub Integers, minimum and maximum number of changes.
term_maxfuns <- function(p, lb, ub, duplication = 1L) {
    invisible(.Call(`_geese_term_maxfuns`, p, lb, ub, duplication))
}

#' @export
#' @rdname geese-terms
term_overall_changes <- function(p, duplication = 1L) {
    invisible(.Call(`_geese_term_overall_changes`, p, duplication))
}

#' @export
#' @rdname geese-terms
term_overall_gains <- function(p, duplication = 1L) {
    invisible(.Call(`_geese_term_overall_gains`, p, duplication))
}

#' @export
#' @rdname geese-terms
term_overall_loss <- function(p, duplication = 1L) {
    invisible(.Call(`_geese_term_overall_loss`, p, duplication))
}

#' @export
#' @rdname geese-terms
term_kgains <- function(p, funs, k = 1L, duplication = 1L) {
    invisible(.Call(`_geese_term_kgains`, p, funs, k, duplication))
}

#' @export
#' @rdname geese-terms
#' @details In the case of `term_neofun_a2b`, `a` represents the origin function
#' from which `b` is originated.
term_neofun_a2b <- function(p, a, b, duplication = 1L) {
    invisible(.Call(`_geese_term_neofun_a2b`, p, a, b, duplication))
}

#' @export
#' @rdname geese-terms
term_genes_changing <- function(p, duplication = 1L) {
    invisible(.Call(`_geese_term_genes_changing`, p, duplication))
}

#' @export
#' @rdname geese-terms
term_prop_genes_changing <- function(p, duplication = 1L) {
    invisible(.Call(`_geese_term_prop_genes_changing`, p, duplication))
}

#' @export
#' @rdname geese-terms
term_coopt <- function(p, a, b, duplication = 1L) {
    invisible(.Call(`_geese_term_coopt`, p, a, b, duplication))
}

#' @export
#' @rdname geese-terms
term_k_genes_changing <- function(p, k, duplication = 1L) {
    invisible(.Call(`_geese_term_k_genes_changing`, p, k, duplication))
}

#' @export
#' @rdname geese-terms
term_less_than_p_prop_genes_changing <- function(p, prop, duplication = 1L) {
    invisible(.Call(`_geese_term_less_than_p_prop_genes_changing`, p, prop, duplication))
}

#' @export
#' @rdname geese-terms
term_pairwise_preserving <- function(p, funA, funB, duplication = 1L) {
    invisible(.Call(`_geese_term_pairwise_preserving`, p, funA, funB, duplication))
}

#' @export
#' @rdname geese-terms
term_gains_from_0 <- function(p, fun, duplication = 1L) {
    invisible(.Call(`_geese_term_gains_from_0`, p, fun, duplication))
}

#' @export
#' @rdname geese-terms
term_overall_gains_from_0 <- function(p, duplication = 1L) {
    invisible(.Call(`_geese_term_overall_gains_from_0`, p, duplication))
}

#' @export
#' @rdname geese-terms
term_pairwise_first_gain <- function(p, funA, funB, duplication = 1L) {
    invisible(.Call(`_geese_term_pairwise_first_gain`, p, funA, funB, duplication))
}

#' @export
#' @rdname geese-terms
term_preserve_pseudogene <- function(p, funA, funB, duplication = 1L) {
    invisible(.Call(`_geese_term_preserve_pseudogene`, p, funA, funB, duplication))
}

#' @export
#' @rdname geese-terms
term_pairwise_overall_change <- function(p, duplication = 1L) {
    invisible(.Call(`_geese_term_pairwise_overall_change`, p, duplication))
}

#' @export
#' @rdname geese-terms
term_pairwise_neofun_singlefun <- function(p, nfun, duplication = 1L) {
    invisible(.Call(`_geese_term_pairwise_neofun_singlefun`, p, nfun, duplication))
}

#' @title GEne Evolutionary model using SufficiEncy (GEESE)
#' @name geese-class
#' @param p An object of class `geese`.
#' @param annotations Vector of integer vectors with annotations.
#' @param geneid integer vector with gene ids.
#' @param parent integer vector with parent gene id.
#' @param duplication logical vector indicating the type of events.
#' @export
#' @aliases geese
new_geese <- function(annotations, geneid, parent, duplication) {
    .Call(`_geese_new_geese`, annotations, geneid, parent, duplication)
}

